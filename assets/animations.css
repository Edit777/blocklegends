/* =======================================================
   BLOCK LEGENDS — RARITY HIGHLIGHT STYLES + ANIMATIONS
   (Clean regen — single source of truth)
   ======================================================= */

/* ----------------------------
   BASE HIGHLIGHT STYLING
----------------------------- */

/* Base highlight — prepare for movement */
.piht__hl{
  display:inline-block;
  position:relative;
  color:var(--piht-hl,currentColor);
  transition:transform .2s ease,text-shadow .2s ease,opacity .2s ease;
}

/* Optional: stronger weight from settings */
.piht__hl--bold{ font-weight:700; }

/* ============================
   RARITY VARIANTS — BASE LOOKS
   ============================ */

/* Common – no animation */
.piht__hl--common{
  text-shadow:none;
}

/* Rare – mild blue glow + gentle bob */
.piht__hl--rare{
  text-shadow:
    0 0 8px rgba(59,130,246,.40),
    0 0 16px rgba(59,130,246,.20);
  animation:bl-rare-bob 2.4s ease-in-out infinite;
}

/* Epic – magenta/violet pulse */
.piht__hl--epic{
  color:#c026d3;
  text-shadow:
    0 0 6px rgba(192,38,211,.60),
    0 0 14px rgba(124,58,237,.40);
  animation:bl-epic-pulse 1.4s ease-in-out infinite;
}

/* Legendary – gold glow + moving shine streak (no background box) */
.piht__hl--legendary{
  color:#facc15;
  background:none;
  -webkit-background-clip:initial;
  background-clip:initial;
  text-shadow:
    0 0 4px rgba(250,204,21,.70),
    0 0 12px rgba(250,204,21,.45);
  position:relative;
  overflow:visible;
}

/* thin shine streak sweeping across the letters */
.piht__hl--legendary::after{
  content:'';
  position:absolute;
  top:-10%;
  left:-40%;
  width:40%;
  height:140%;
  background:linear-gradient(90deg,transparent,rgba(255,255,255,.95),transparent);
  transform:skewX(-20deg);
  opacity:0;
  pointer-events:none;
  animation:bl-legendary-shine 2.8s linear infinite;
}

/* Special – drifting label */
.piht__hl--special{
  text-shadow:
    0 0 8px rgba(4,120,87,.60),
    0 0 16px rgba(4,120,87,.30);
  animation:bl-special-float 2.8s ease-in-out infinite;
}

/* =======================================================
   MYTHICAL — STABLE CREEPY BLOOD (WORD-LEVEL, NOT PER-LETTER)
   Works whether you have .piht__hl-char spans or not.
   ======================================================= */

.piht__hl--mythical{
  position: relative;
  display: inline-block;
  color:#d0f44f;
  text-shadow:
    0 0 4px rgba(182, 255, 120, .95),
    0 0 10px rgba(63, 98, 18, .65),
    0 6px 8px rgba(30, 41, 15, .55);
  filter: drop-shadow(0 2px 2px rgba(0,0,0,.35));
  overflow: visible;
  animation: bl-myth-glow 3s ease-in-out infinite;
}

/* wet film crawling over the letters */
.piht__hl--mythical::before{
  content:"";
  position:absolute;
  inset:-8% -6% -2%;
  background:
    radial-gradient(120% 90% at 10% 10%, rgba(217,255,157,.24) 0%, transparent 55%),
    radial-gradient(70% 60% at 80% 35%, rgba(177,244,117,.28) 0%, transparent 60%),
    radial-gradient(90% 60% at 40% 75%, rgba(132,204,22,.22) 0%, transparent 65%),
    linear-gradient(180deg, rgba(173,232,92,.30) 0%, rgba(77,124,15,.08) 100%);
  opacity:.75;
  mix-blend-mode:screen;
  border-radius:20px;
  pointer-events:none;
  animation: bl-myth-film 6s ease-in-out infinite;
}

/* swampy shelf under the word + heavy drips */
.piht__hl--mythical::after{
  content:"";
  position:absolute;
  left:-4px;
  right:-4px;
  top:calc(100% - 2px);
  height:26px;
  pointer-events:none;
  opacity:.95;
  transform-origin: top;
  filter: drop-shadow(0 2px 3px rgba(0,0,0,.45));
  background-image:
    linear-gradient(to bottom, rgba(104,159,35,.95) 0%, rgba(55,83,20,.92) 60%, rgba(34,54,12,0) 100%),
    linear-gradient(to bottom, rgba(176,232,70,.0) 0%, rgba(176,232,70,.90) 18%, rgba(92,133,34,.85) 65%, rgba(52,83,21,0) 100%),
    linear-gradient(to bottom, rgba(176,232,70,.0) 0%, rgba(176,232,70,.92) 26%, rgba(92,133,34,.85) 70%, rgba(52,83,21,0) 100%),
    linear-gradient(to bottom, rgba(176,232,70,.0) 0%, rgba(176,232,70,.88) 22%, rgba(92,133,34,.85) 68%, rgba(52,83,21,0) 100%);
  background-size:
    100% 7px,
    8px 26px,
    6px 20px,
    9px 24px;
  background-position:
    0 0,
    22% 0,
    56% 0,
    83% 0;
  background-repeat:no-repeat;
  border-radius:12px;
  box-shadow:
    6px 12px 0 0 rgba(71,109,28,.65),
    -10px 14px 0 0 rgba(71,109,28,.55),
    18px 16px 0 0 rgba(71,109,28,.50);
  animation: bl-myth-drip 4.4s ease-in-out infinite;
}

.piht__hl--mythical .piht__hl-char{ position:relative; }

.piht__hl--mythical .piht__hl-char::before{
  content:"";
  position:absolute;
  left:50%;
  top:90%;
  width:6px;
  height:16px;
  background:linear-gradient(180deg, rgba(192,255,115,.95) 0%, rgba(85,130,26,.85) 80%, rgba(52,83,21,0) 100%);
  border-radius:9999px;
  transform:translateX(-50%) scaleY(.85);
  opacity:.7;
  filter: drop-shadow(0 1px 2px rgba(0,0,0,.35));
  animation: bl-myth-dribble 3.6s ease-in-out infinite;
  animation-delay: calc(var(--piht-char-index, 1) * 110ms);
}

.piht__hl--mythical .piht__hl-char::after{
  content:"";
  position:absolute;
  left:50%;
  bottom:6px;
  width:10px;
  height:10px;
  background:radial-gradient(circle at 40% 40%, rgba(195,255,125,.95) 0%, rgba(73,110,26,.9) 60%, rgba(40,62,17,.0) 100%);
  border-radius:50%;
  transform:translateX(-50%) scale(0.8);
  opacity:.55;
  animation: bl-myth-bubble 2.8s ease-in-out infinite;
  animation-delay: calc(var(--piht-char-index, 1) * 140ms);
}

@keyframes bl-myth-glow{
  0%,100%{
    text-shadow:
      0 0 4px rgba(182, 255, 120, .95),
      0 0 12px rgba(92, 133, 34, .75),
      0 7px 10px rgba(30, 41, 15, .65);
    transform:translateY(0);
  }
  50%{
    text-shadow:
      0 0 8px rgba(217, 255, 157, 1),
      0 0 18px rgba(126, 173, 45, .85),
      0 12px 12px rgba(16, 24, 8, .70);
    transform:translateY(-1px);
  }
}

@keyframes bl-myth-film{
  0%{ transform:translateY(-2px) scaleX(1); opacity:.70; }
  40%{ transform:translateY(1px) scaleX(1.01); opacity:.82; }
  70%{ transform:translateY(0) scaleX(.995); opacity:.78; }
  100%{ transform:translateY(-2px) scaleX(1); opacity:.70; }
}

/* thick under-shelf breathing as drips pull down */
@keyframes bl-myth-drip{
  0%,100%{
    opacity: .90;
    transform: translateY(0) scaleY(.94);
    box-shadow:
      6px 12px 0 0 rgba(71,109,28,.65),
      -10px 14px 0 0 rgba(71,109,28,.55),
      18px 16px 0 0 rgba(71,109,28,.50);
  }
  50%{
    opacity: 1;
    transform: translateY(2px) scaleY(1);
    box-shadow:
      8px 16px 0 0 rgba(71,109,28,.70),
      -12px 18px 0 0 rgba(71,109,28,.60),
      22px 20px 0 0 rgba(71,109,28,.55);
  }
}

/* per-letter dribble stretch */
@keyframes bl-myth-dribble{
  0%,100%{ transform:translateX(-50%) scaleY(.8); opacity:.65; }
  40%{ transform:translateX(-50%) scaleY(1.05); opacity:.85; }
  80%{ transform:translateX(-50%) scaleY(.9); opacity:.72; }
}

@keyframes bl-myth-bubble{
  0%,100%{ transform:translateX(-50%) scale(.7); opacity:.45; }
  50%{ transform:translateX(-50%) translateY(-3px) scale(1); opacity:.75; }
}

/* =======================================================
   ANIMATIONS (KEYFRAMES)
   ======================================================= */

/* Rare – gentle bob */
@keyframes bl-rare-bob{
  0%,100%{ transform:translateY(0); opacity:.95; }
  50%{ transform:translateY(-2px); opacity:1; }
}

/* Epic – quick “hero” pulse */
@keyframes bl-epic-pulse{
  0%,100%{ transform:scale(1) translateY(0); }
  30%{ transform:scale(1.05) translateY(-1px); }
  60%{ transform:scale(1.02) translateY(0); }
}

/* Legendary – moving shine stripe */
@keyframes bl-legendary-shine{
  0%{ left:-40%; opacity:0; }
  20%{ opacity:1; }
  60%{ left:140%; opacity:0; }
  100%{ left:140%; opacity:0; }
}

/* Special – float / drift */
@keyframes bl-special-float{
  0%,100%{ transform:translateY(0) translateX(0); }
  25%{ transform:translateY(-2px) translateX(1px); }
  50%{ transform:translateY(-3px) translateX(0); }
  75%{ transform:translateY(-2px) translateX(-1px); }
}


/* Accessibility: reduce motion if user prefers */
@media (prefers-reduced-motion: reduce){
  .piht__hl--rare,
  .piht__hl--epic,
  .piht__hl--legendary,
  .piht__hl--mythical,
  .piht__hl--special{
    animation:none !important;
    transform:none !important;
    text-shadow:none !important;
  }

  .piht__hl--legendary::after,
  .piht__hl--mythical::before,
  .piht__hl--mythical::after,
  .piht__hl--mythical .piht__hl-char::before,
  .piht__hl--mythical .piht__hl-char::after{
    animation:none !important;
    opacity:0 !important;
    height:0 !important;
    width:0 !important;
  }
}
