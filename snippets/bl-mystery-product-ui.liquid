<div
  data-bl-mystery-ui
  data-product-handle="{{ product.handle }}"
  data-collections='{% capture bl_collections_json %}[
    {%- assign is_first = true -%}
    {%- for link in linklists['all-collections'].links -%}
      {%- if link.type == 'collection_link' -%}
        {%- unless is_first -%},{%- endunless -%}
        {"handle":"{{ link.object.handle | escape }}","title":"{{ link.object.title | escape_once }}"}
        {%- assign is_first = false -%}
      {%- endif -%}
    {%- endfor -%}
  ]{% endcapture %}{{ bl_collections_json | strip_newlines | escape }}'
>
  <div class="bl-mystery-controls" data-bl-mystery-controls>
    <div class="bl-mystery-pref" data-bl-pref-collection-wrap style="display: none;">
      <label for="BLPreferredCollection-{{ section.id }}" class="bl-mystery-label">Collection</label>
      <select id="BLPreferredCollection-{{ section.id }}" class="bl-mystery-select" data-bl-pref-collection-select>
        {%- for link in linklists['all-collections'].links -%}
          {%- if link.type == 'collection_link' -%}
            <option value="{{ link.object.handle }}">{{ link.object.title }}</option>
          {%- endif -%}
        {%- endfor -%}
      </select>
    </div>
    <div class="bl-mystery-hint" data-bl-mystery-hint></div>
  </div>
</div>
<div class="bl-mystery-notice" data-bl-mystery-notice aria-live="polite" style="display: none;"></div>
